import{A as b,t as x,r as f,Z as S,u as v,m as I,j as o}from"./index-CKPnHyJz.js";import{c as j}from"./mortgage.service--8zI_Om6.js";import{t as w,B as V}from"./Button-BvF3sJ3E.js";import"./createLucideIcon-DSG_fHGP.js";function h(e){return typeof e!="string"?0:+e.replace(/[$\s.]/g,"")}function N(e,n){if(e instanceof b){x.error(e.response?.data.error||"Connection failed with the server");return}x.error(n)}function M(e){const[n,t]=f.useState(e);function r(s){return s.replace(/[^\d]/g,"")}return{...n,formState:n,onInputOccupancy:({target:s})=>{const{name:u,value:i}=s;t({...n,[u]:i})},onInputChange:({target:s})=>{const{name:u,value:i}=s,y=`$ ${r(i).replace(/\B(?=(\d{3})+(?!\d))/g,".")}`;t({...n,[u]:y})},onInputCreditScore:({target:s})=>{const{name:u,value:i}=s,g=r(i);t({...n,[u]:g})},onResetForm:()=>{t(e)}}}const E=e=>{const[n,t]=f.useState(e);return{errors:n,resetErrors:()=>{t(e)},validateFields:c=>{if(c instanceof S){const m={};c.issues.forEach(l=>{l.path.length>0&&(m[String(l.path[0])]=l.message)}),t(m)}}}};function D(){const e={creditScore:"",loanAmount:"",monthlyDebts:"",monthlyIncome:"",occupancyType:"",propertyValue:""},[n,t]=f.useState(!1),{addMortgage:r}=v(),{formState:a,onInputChange:c,onInputCreditScore:m,onInputOccupancy:l,onResetForm:s}=M(e),{errors:u,resetErrors:i,validateFields:g}=E(e),y={creditScore:+a.creditScore,loanAmount:h(a.loanAmount),monthlyDebts:h(a.monthlyDebts),monthlyIncome:h(a.monthlyIncome),occupancyType:a.occupancyType.toLowerCase(),propertyValue:h(a.propertyValue)};async function C(){t(!0);try{I.parse(a);const{data:p}=await j(y);r(p),s(),i()}catch(p){g(p),p instanceof b&&N(p,"Connection failed with the server")}finally{t(!1)}}return{...a,formState:a,loading:n,errors:u,onInputChange:c,onInputCreditScore:m,onInputOccupancy:l,onGenerateMortgage:C}}const d=({id:e,label:n,error:t,warningMessage:r,className:a,...c})=>o.jsxs("fieldset",{children:[n&&o.jsx("label",{htmlFor:e,className:"block text-sm mb-1 text-slate-500",children:n}),o.jsx("div",{className:"relative",children:o.jsx("input",{id:e,name:e,className:w(`focus-visible:outline-none h-10 px-3 border border-slate-300 focus:ring-0 focus-visible:ring-0 rounded-lg placeholder:text-gray-400 text-slate-700 text-sm ${t?"border-red-500":""}`,a),...c})}),t&&o.jsx("p",{className:"text-red-500 text-xs mt-1 flex items-center gap-2",children:r})]});function T(){const{errors:e,loading:n,formState:t,onInputChange:r,onInputCreditScore:a,onInputOccupancy:c,onGenerateMortgage:m}=D(),l=async s=>{s.preventDefault(),await m()};return o.jsxs("section",{className:"rounded-lg p-4 border border-slate-300",children:[o.jsx("header",{className:"mb-4 text-center",children:o.jsx("h2",{className:"text-xl font-bold",children:"Calculate your mortgage"})}),o.jsx("hr",{className:"my-4 border-slate-300"}),o.jsxs("form",{noValidate:!0,onSubmit:l,className:"grid grid-cols-2 gap-4",children:[o.jsx(d,{label:"Monthly income",id:"monthlyIncome",className:"w-full flex-1",placeholder:"$1.500",value:t.monthlyIncome,onChange:r,maxLength:10,error:!!e.monthlyIncome,warningMessage:e.monthlyIncome}),o.jsx(d,{label:"Monthly debts",id:"monthlyDebts",className:"w-full",placeholder:"$500",value:t.monthlyDebts,onChange:r,maxLength:10,error:!!e.monthlyDebts,warningMessage:e.monthlyDebts}),o.jsx(d,{label:"Loan amount",id:"loanAmount",className:"w-full",placeholder:"$250.000",value:t.loanAmount,onChange:r,maxLength:10,error:!!e.loanAmount,warningMessage:e.loanAmount}),o.jsx(d,{label:"Property value",id:"propertyValue",className:"w-full",placeholder:"$300.000",value:t.propertyValue,onChange:r,maxLength:10,error:!!e.propertyValue,warningMessage:e.propertyValue}),o.jsx(d,{label:"Credit score",id:"creditScore",className:"w-full",placeholder:"720",value:t.creditScore,onChange:a,maxLength:3,error:!!e.creditScore,warningMessage:e.creditScore}),o.jsx(d,{label:"Occupation",id:"occupancyType",className:"w-full",placeholder:"Developer",value:t.occupancyType,onChange:c,error:!!e.occupancyType,warningMessage:e.occupancyType}),o.jsx(V,{className:"col-span-2",loading:n,disabled:n,children:"Calculate your mortgage"})]})]})}export{T as default};
